<!DOCTYPE html>
<html lang="en">
	<head>
		
		<title> "The Joy of Convolution" </title>
	</head>
	
	<body>
		<h1> The joy of convolution </h1>	
		
		<script>
			var w = window.innerWidth;
			var h = window.innerHeight;
		</script>
		
		
	

		<div>
			<canvas id='canvasXT' width='300' height='150' style='border:black 1px solid'>
				Your browser does not support the canvas element.
			</canvas>


			<canvas id='canvasHT' width='300' height='150' style='border:black 1px solid'>
				Your browser does not support the canvas element.
			</canvas>
		<div>
			<canvas id='canvasHTANDXT' width ='606' height='150' style='border:black 1px solid'>
				Your browser does not support the canvas element.
			</canvas>
		</div>	
			<canvas id='canvasHTXT' width='606' height='150' style='border:black 1px solid'>
				Your browser does not support the canvas element.
			</canvas>
		</div>

	
		<script>
			var canvasXT = document.getElementById("canvasXT");
			var context = canvasXT.getContext("2d");
			var canvasHT = document.getElementById("canvasHT");
			var ctxHT = canvasHT.getContext("2d");
			var canvasHTANDXT = document.getElementById("canvasHTANDXT");
			var ctxHTANDXT = canvasHTANDXT.getContext("2d");	
			var canvasHTXT = document.getElementById("canvasHTXT");
			var ctxHTXT = canvasHTXT.getContext("2d");

			canvasHT.addEventListener("mousedown", doMouseDownCount, false);
			canvasXT.addEventListener("mousedown", doMouseDownCount, false);
			canvasXT.addEventListener("mousemove", redrawXT, false);
			canvasHT.addEventListener("mousemove", redrawHT, false);
			canvasHTANDXT.addEventListener("mousemove", redrawHTXT, false);	
			var xT = new Array(canvasXT.width);
			var hT = new Array(canvasHT.width);
			var hTxT = new Array(canvasHTXT.width);
			var hTandxT = new Array(canvasHTANDXT.width);

			for(i = 0; i < canvasHT.width; i++) hT[i] = Math.sin(i/20);
			for(i = 0; i < canvasXT.width; i++) xT[i] = Math.sin(i/20);

			hTxTArray(0);
			function hTxTArray(j) {
				var k = 0;
				var h = 0;
				var drawing = 0;
				var drawing2 = 0;
				for(i = 0; i < canvasHTXT.width; i++) hTxT[i] = 0;
				for(i = 0; i < canvasHTXT.width; i++) {
					if (j === i) drawing = 1;
					if (100 === i) drawing2 = 1;	
					if(drawing >= 0 && k < canvasXT.width) {	
						hTxT[i] = xT[k];
						k++; h++; j++;
					}
					else { k = 0; drawing = 0; }
				}
			}

			var red = '#FF0000';
			var blue = '#0000FF';
			var grey = '#888888';
			
			drawAxis(context, "x(t)", canvasXT);
			drawGraph(context, xT, canvasXT, red, 0);
			drawAxis(ctxHT, "h(t)", canvasHT);
			drawGraph(ctxHT, hT, canvasHT, blue, 0);
			drawAxis(ctxHTXT, "x(t)*h(t)", canvasHTXT);
			drawGraph(ctxHTXT, hTxT, canvasHTXT, grey, 0);
			drawAxis(ctxHTANDXT, "x(t) and h(t)", canvasHTANDXT);
			drawGraph(ctxHTANDXT, hT, canvasHTANDXT, blue, 100);
			drawGraph(ctxHTANDXT, xT, canvasHTANDXT, red, 300);
			

			var count = 0;



			function doMouseDownCount(event) {
				count++;	
			}
			
			function redrawXT(event) {	
				redrawGraph(context, xT, canvasXT, "x(t)", red, 0);
			}
			function redrawHT() { 
				redrawGraph(ctxHT, hT, canvasHT, "h(t)", blue, 0);
			}
			function redrawHTXT() {
	
					ctxHTANDXT.clearRect(0,0,canvasHTANDXT.width, canvasHTANDXT.height);
					ctxHTXT.clearRect(0,0,canvasHTANDXT.width, canvasHTANDXT.height);
					hTxTArray(event.pageX);
					drawAxis(ctxHTXT, "x(t)*h(t)", canvasHTXT);
					drawGraph(ctxHTXT, hTxT, canvasHTXT, grey, event.pageX);
					drawAxis(ctxHTANDXT, "x(t) and x(t)", canvasHTANDXT);
					drawGraph(ctxHTANDXT, xT, canvasHTANDXT, red, event.pageX);
					drawGraph(ctxHTANDXT, hT, canvasHTANDXT, blue, 100);

			}	
			function redrawGraph(ctx, array, canvas, string, colour, offset) {
				if(count%2 === 0) { 
					var transform = 1-(event.pageY - canvas.offsetTop)*2/canvas.height;
					ctx.clearRect(0,0,canvas.width, canvas.height);
					for(i = -6; i < 7; i++)
						array[event.pageX - canvas.offsetLeft + i] = transform;
					hTxTArray(0);
					drawAxis(ctx, string, canvas);
					drawGraph(ctx, array, canvas, colour, offset);
				}
			
			}
	
			function drawAxis(ctx, string, canvas) {
				ctx.strokeStyle = '#888888';
				
				ctx.beginPath();
				ctx.moveTo(0,canvas.height/2);
				ctx.lineTo(canvas.width, canvas.height/2);
				ctx.moveTo(canvas.width/2, 0);
				ctx.lineTo(canvas.width/2,canvas.height);
				
				ctx.stroke();

				ctx.font = "20px Arial";
				ctx.fillText(string, 20, 20);
			}	
			
			function drawGraph(ctx, array, canvas, colour, offset) {		
				var h2 = canvas.height/2;
				ctx.beginPath();		
				//ctx.moveTo(0, h2*(-array[0]+1));
				//ctx.lineTo(1, h2*(-array[0]+1));	

				for(i = 1; i < canvas.width; i++) {
					ctx.lineTo(i+offset, h2*(-array[i]+1));
					ctx.lineTo(i+1+offset,h2*(-array[i]+1));
				}
				ctx.strokeStyle = colour;	
				ctx.stroke();	
			}
		</script>
	</body>
</html>
